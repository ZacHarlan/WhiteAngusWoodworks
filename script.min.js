document.addEventListener('DOMContentLoaded',()=>{const header=document.querySelector('.site-header');const navToggle=document.querySelector('.nav-toggle');const primaryNav=document.querySelector('#primary-nav');const navOverlay=document.createElement('div');navOverlay.classList.add('nav-overlay');document.body.insertBefore(navOverlay,document.body.firstChild);window.addEventListener('scroll',()=>{if (window.scrollY > 50){header.classList.add('scrolled');}else{header.classList.remove('scrolled');}});navToggle.addEventListener('click',()=>{const isExpanded=navToggle.getAttribute('aria-expanded')==='true';toggleNav(!isExpanded);});navOverlay.addEventListener('click',()=>{toggleNav(false);});primaryNav.querySelectorAll('a').forEach(link=>{link.addEventListener('click',(e)=>{toggleNav(false);});});function toggleNav(show){navToggle.setAttribute('aria-expanded',show);primaryNav.setAttribute('data-visible',show);if (show){navOverlay.classList.add('active');document.body.style.overflow='hidden';}else{navOverlay.classList.remove('active');document.body.style.overflow='';}}const observerOptions={root: null,rootMargin: '0px',threshold: 0.15};const revealObserver=new IntersectionObserver((entries,observer)=>{entries.forEach(entry=>{if (entry.isIntersecting){entry.target.classList.add('visible');observer.unobserve(entry.target);}});},observerOptions);document.querySelectorAll('.reveal-section,.reveal-item').forEach(el=>{revealObserver.observe(el);});const filterBtns=document.querySelectorAll('.filter-btn');const galleryItems=document.querySelectorAll('.gallery-item');const loadMoreBtn=document.getElementById('load-more');const savedFilter=localStorage.getItem('galleryFilter') || 'all';applyFilter(savedFilter);updateActiveButton(savedFilter);filterBtns.forEach(btn=>{btn.addEventListener('click',()=>{const filterValue=btn.getAttribute('data-filter');applyFilter(filterValue);updateActiveButton(filterValue);localStorage.setItem('galleryFilter',filterValue);});});function applyFilter(filter){let visibleCount=0;galleryItems.forEach(item=>{const category=item.getAttribute('data-category');if (filter==='all' || category===filter){item.classList.remove('hidden');item.style.display='block';visibleCount++;}else{item.classList.add('hidden');item.style.display='none';}});if (loadMoreBtn){loadMoreBtn.style.display=visibleCount > 8 ? 'inline-block' : 'none';}}function updateActiveButton(filter){filterBtns.forEach(btn=>{if (btn.getAttribute('data-filter')===filter){btn.classList.add('active');}else{btn.classList.remove('active');}});}if (loadMoreBtn){loadMoreBtn.addEventListener('click',()=>{alert('In a real implementation,this would load the next page of items from the server or JSON file.');});}const lightbox=document.getElementById('lightbox');const lightboxImg=document.getElementById('lightbox-img');const lightboxClose=document.getElementById('lightbox-close');const prevBtn=document.getElementById('lightbox-prev');const nextBtn=document.getElementById('lightbox-next');let currentImageIndex=0;const getVisibleItems=()=> Array.from(document.querySelectorAll('.gallery-item:not(.hidden) img'));galleryItems.forEach(item=>{const img=item.querySelector('img');img.addEventListener('click',()=>{const visibleImages=getVisibleItems();currentImageIndex=visibleImages.indexOf(img);openLightbox(img.src);});item.addEventListener('keydown',(e)=>{if (e.key==='Enter'){img.click();}});});function openLightbox(src){lightboxImg.src=src;lightbox.classList.add('active');lightbox.setAttribute('aria-hidden','false');document.body.style.overflow='hidden';lightboxClose.focus();}function closeLightbox(){lightbox.classList.remove('active');lightbox.setAttribute('aria-hidden','true');document.body.style.overflow='';}function showNextImage(){const visibleImages=getVisibleItems();currentImageIndex=(currentImageIndex+1) % visibleImages.length;lightboxImg.src=visibleImages[currentImageIndex].src;}function showPrevImage(){const visibleImages=getVisibleItems();currentImageIndex=(currentImageIndex-1+visibleImages.length) % visibleImages.length;lightboxImg.src=visibleImages[currentImageIndex].src;}lightboxClose.addEventListener('click',closeLightbox);lightbox.addEventListener('click',(e)=>{if (e.target===lightbox) closeLightbox();});nextBtn.addEventListener('click',(e)=>{e.stopPropagation();showNextImage();});prevBtn.addEventListener('click',(e)=>{e.stopPropagation();showPrevImage();});document.addEventListener('keydown',(e)=>{if (!lightbox.classList.contains('active')) return;if (e.key==='Escape') closeLightbox();if (e.key==='ArrowRight') showNextImage();if (e.key==='ArrowLeft') showPrevImage();});const quoteForm=document.getElementById('quote-form');const formStatus=document.getElementById('form-status');if (quoteForm){quoteForm.addEventListener('submit',(e)=>{e.preventDefault();let isValid=true;const inputs=quoteForm.querySelectorAll('input[required],textarea[required]');inputs.forEach(input=>{const formGroup=input.parentElement;if (!input.checkValidity()){formGroup.classList.add('error');isValid=false;}else{formGroup.classList.remove('error');}input.addEventListener('input',()=>{formGroup.classList.remove('error');});});if (isValid){const btn=quoteForm.querySelector('button[type="submit"]');const originalText=btn.innerText;btn.innerText='Sending...';btn.disabled=true;setTimeout(()=>{formStatus.innerText='Message sent successfully! We will be in touch soon.';formStatus.style.color='green';quoteForm.reset();btn.innerText=originalText;btn.disabled=false;},1500);}});}document.getElementById('year').textContent=new Date().getFullYear();});